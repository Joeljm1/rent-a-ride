#!/usr/bin/env bash

URL="http://localhost:5173/api/gps/updateLoc"
GPS_ID="fTETsx38gK"
GPS_PASS="12345678"

# Array of [lat, lon] pairs
COORDS=(
  "9.754270,76.651331"
  "9.754080,76.651256"
  "9.753900,76.651224"
  "9.753604.76.651160"
  "9.753341,76.651032"
  "9.753028,76.650994"
  "9.752752,76.650981"
  "9.752615,76.650943"
  "9.752301,76.650765"
  "9.752113,76.650638"
  "9.751687,76.650384"
  "9.751361,76.650218"
  "9.751111,76.650078"
  "9.750860,76.649849"
  "9.750635,76.649608"
  "9.750559,76.649137"
  "9.750522,76.648680"
  "9.750396,76.648470"
  "9.750259,76.648209"
  "9.750165,76.647987"
  "9.750052,76.647726"
  "9.750008,76.647510"
  "9.749817,76.646503"
  "9.749707,76.646180"
  "9.749666,76.646093"
  "9.749555,76.645906"
  "9.749464,76.645720"
  "9.749382,76.645574"
  "9.749294,76.645434"
  "9.749205,76.645326"
  "9.749127,76.645210"
  "9.749050,76.645126"
  "9.748979,76.645021"
  "9.748853,76.644860"
  "9.748785,76.644764"
  "9.748705,76.644635"
  "9.748614,76.644510"
  "9.748520,76.644369"
  "9.748432,T6.644277"
)

for coord in "${COORDS[@]}"; do
  LAT="${coord%,*}"   # part before comma
  LON="${coord#*,}"   # part after comma

  BODY=$(jq -nc \
    --arg gpsId "$GPS_ID" \
    --arg gpsPass "$GPS_PASS" \
    --argjson lat "$LAT" \
    --argjson lon "$LON" \
    '{gpsId: $gpsId, gpsPass: $gpsPass, lat: $lat, lon: $lon}')

  echo "Sending: lat=$LAT lon=$LON"
  curl -s -X POST -H "Content-Type: application/json" -d "$BODY" "$URL"
  echo ""
  sleep 1
done
